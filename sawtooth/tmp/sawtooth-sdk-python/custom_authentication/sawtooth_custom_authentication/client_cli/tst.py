class RSA2048_Accumulator():
    def __init__(self, elements):
        # using script gen_lambda_prime.py to generate rsa numbers

        self.bit_size = 2048
        # 1024 prime p
        self.p = 113670207059472357294514906434140228244224371158243706157752108233778974655713740513597953023188318667552954790790638395628526516329951545235369685235873350786560803494607526623162240272656430745550814082183865195966354201453031082228756766059602964431448110328722449965222902737515202809785178422613978502931
        # 1024 prime p
        self.q = 147265752317501722089328894904235088512725069240326262228659935076191725881274747935516458170799993276674582560393284210244971044740643535655999236410631503013658496964673463033170806886301792420341388695529929848329162517216968731395576588606412638961088195061836057016453714451935432698443875700575056161069
        # 2048 bit N as RSA modulus p*q = N
        self.N = 16739728558699391911822487003799290775719365607538691037232220713757382176565946751059082882141631611098534251238501248016564261277809784947486006859170443128299662238925543090741122401455308789259340742236936696983791412289788877626507217895669058048736288380565441381607358151896005998515472554392145192875871118544996000971245529197829374877403983235150658268815562413283974314887615452315005396127544578045775189061277974328030458361944837246404048304138744948782623840402590497542900521385713890679906547076127719010280655357233572490215883547810102333526480980011508520503945097174448707895057050692392624593239
        # PHI (p-1)(q-1)
        self.phi = 16739728558699391911822487003799290775719365607538691037232220713757382176565946751059082882141631611098534251238501248016564261277809784947486006859170443128299662238925543090741122401455308789259340742236936696983791412289788877626507217895669058048736288380565441381607358151896005998515472554392145192875610182585619026891861685396490999560647033794752088300429150369974003614350626963865890984933556266101547651710094051722156960800874242165512679382492240094982404539943309507886567474226755667514014344298413923965985138638563572676591550193144086730133944674620950013522268479984998072386827996569203589929240
        # g=3 works, look at the script pick_g-2.py
        self.g=3
        # squaring g mod N
        self.g_acc=9
        # generate x elements, hash to primes
        self.tails = elements
        self.modulus = self.N
        if len(elements) > 0:
            self.value = pow(self.g_acc, elements[0], self.modulus)
            for x in elements[1:]:
                self.value = pow(self.g_acc, x, self.modulus)
        else:
            self.value = self.g_acc

    def add(self, x):
        if x not in self.tails:
            old_value = self.value
            self.tails.append(x)

            self.value = pow(old_value, x, self.modulus)
            return self.value

    def remove(self, x):
        if x in self.tails:
            old_value = self.value
            self.tails.remove(x)

            invers = pow(x, -1, self.phi)
            result = pow(self.value, invers, self.modulus)
            self.value = result
            return result

    def gen_witness(self, x_new):
        wit = self.g_acc
        for x in self.tails:
            if x == x_new:
                continue
            wit = pow(wit, x, self.modulus)
        return wit

    def verify_membership(self, wit_t, x_t):
        if pow(wit_t, x_t, self.modulus) == self.value:
            return True
        else:
            return False

    def get_modulus(self):
        return self.modulus

    def get_acc_value(self):
        return self.value

if __name__ == "__main__":
    rsa = RSA2048_Accumulator([])
    p1= int(input())
    rsa.add(p1)
    wit1 = rsa.gen_witness(p1)
    print("Wit 1: ", wit1)
    print("Acc value 1: ", rsa.get_acc_value())

    p2 = int(input())
    rsa.add(p2)
    wit2 = rsa.gen_witness(p2)
    print("Wit 2: ", wit2)
    print("Acc value 2: ", rsa.get_acc_value())

    p3 = int(input())
    rsa.add(p3)
    wit3 = rsa.gen_witness(p3)
    print("Wit 3: ", wit3)
    print("Acc value 3: ", rsa.get_acc_value())